/**!
 * GremlinJS 0.3.5
 * https://github.com/grmlin/gremlinjs
 *
 * Copyright 2012, Andreas Wehr
 * Released under the MIT License
 */

(function(){(function(){var e={}.hasOwnProperty;define("gremlinjs/core/helper",[],function(){var t,n,r,i,s,o,u,a;return o="undefined",i="object",s="string",n="function",r="number",t=0,a=function(t,n){var r,i;for(i in n){if(!e.call(n,i))continue;r=n[i],t[i]=r}return t},u={isUndefined:function(e){return typeof e===o},isFunction:function(e){return typeof e===n},isArray:function(e){return e instanceof Array},isObject:function(e){return e!==null&&typeof e===i&&!u.isArray(e)},isNumber:function(e){return typeof e===r},isString:function(e){return typeof e===s},isEmptyString:function(e){return u.isString(e)&&e.length===t},isJquery:function(e){return u.isObject(e)&&u.isString(e.jquery)},log:function(){if(u.isObject(console)&&u.isFunction(console.log))return console.log.apply(console,arguments)},warn:function(){if(u.isObject(console)&&u.isFunction(console.warn))return console.warn.apply(console,arguments)},mixin:function(e,t){if(!u.isFunction(e))throw new TypeError("target has to be a (constructor) function. Only prototypes will be extended");if(!u.isObject(t))throw new TypeError("object has to be used to extend prototype");return a(e.prototype,t)}}})}).call(this),function(){define("gremlinjs/gremlins/GremlinFactory",["../core/helper"],function(e){var t,n;return n=0,t={error:function(t){return e.warn("GremlinFactory#createGremlin> The gremlin module "+t+" didn't return a (constructor) function and will not work!")},createGremlin:function(r,i,s){var o;return o=n+=1,require([r],function(n){var u;return e.isFunction(n)?(u=new n(i,i.data(),o+=1),s.apply(null,[u]),!0):t.error(r)})}}})}.call(this),function(){define("gremlinjs/gremlins/Loader",["jquery","../core/helper","./GremlinFactory"],function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p,d;return d=0,i=e(window),r=e("body"),l=",",o="data-gremlin-name",s="data-lazy-load",u="gremlin",a="",f="gremlin-loading",c="gremlin-ready",p=[],h=function(){function r(e,t){this._namespace=e!=null?e:a,this._gremlinCssClass=t!=null?t:u,this._lazyLoadQueue=[],this._bindLazyLoading()}return r.prototype.load=function(n){var r,i=this;return this._cleanUp(),t.isJquery(n)?r=n.find("."+this._gremlinCssClass):r=e("."+this._gremlinCssClass),r.each(function(e,n){var r,s,u,a,f,c;s=n.getAttribute(o);if(!t.isString(s)||t.isEmptyString(s))throw new Error("Can't create a gremlin without a classname defined for it.");f=s.split(l),c=[];for(u=0,a=f.length;u<a;u++){r=f[u],r=i._namespace+r;if(!t.isString(r)||!!t.isEmptyString(r))throw new Error("Can't create a gremlin without a classname defined for it.");c.push(i._addGremlin(r,n))}return c}),this._handleScrollEvent()},r.prototype.resetLazyGremlins=function(){var e,t,n,r;r=this._lazyLoadQueue;for(t=0,n=r.length;t<n;t++)e=r[t],e.top=e.$element.offset().top,e.height=e.$element.outerHeight();return this._handleScrollEvent()},r.prototype._bindLazyLoading=function(){var e,t,n=this;return e=null,t="scroll.Loader"+(d+=1),this._lazyLoadQueue=[],i.unbind(t).bind(t,function(){return e&&clearTimeout(e),e=setTimeout(function(){return n._handleScrollEvent()},250)})},r.prototype._addGremlin=function(t,n){var r,i;return r=e(n),i=n.getAttribute(s)==="true",r.removeClass(this._gremlinCssClass),i?this._lazyLoadQueue.push({name:t,$element:r,top:r.offset().top,height:r.outerHeight()}):this._createGremlin(t,r)},r.prototype._createGremlin=function(e,t){var r=this;return t.addClass(f),n.createGremlin(e,t,function(e){return p.push(e),e.bind(e.NOTIFICATION,function(t,n){if(n.interest===e.CONTENT_CHANGED)return r.load(e.view)}),t.removeClass(f).addClass(c),!0})},r.prototype._handleScrollEvent=function(){var e;return e=i.scrollTop(),this._checkLazyGremlins(e-100,e+100+i.height())},r.prototype._checkLazyGremlins=function(e,t){var n,r,i,s,o,u;if(this._lazyLoadQueue.length>0){r=[],o=this._lazyLoadQueue,u=[];for(i=0,s=o.length;i<s;i++)n=o[i],n.top+n.height>e&&n.top<t?this._createGremlin(n.name,n.$element):r.push(n),u.push(this._lazyLoadQueue=r);return u}},r.prototype._cleanUp=function(){var e,t,n,r,i;e=[];for(n=0,r=p.length;n<r;n++)t=p[n],((i=t.view)!=null?i.closest("html").length:void 0)===0?t=null:e.push(t);return p=e},r}(),h})}.call(this),function(){define("gremlinjs/gremlins/LoaderPool",["./Loader"],function(e){var t,n,r;return t={},n={},r={getInstance:function(r,i){var s;s=""+r+"_"+i;if(typeof t[s]=="undefined"&&n[i]===!0)throw new Error("Trying to use the same css class ("+i+") with multiple namespaces. ");return n[i]=!0,t[s]||(t[s]=new e(r,i))}}})}.call(this),function(){define("gremlinjs/event/EventDispatcher",["../core/helper"],function(e){var t;return t={_observers:null,bind:function(t,n,r){var i;r==null&&(r=null),this._observers||(this._observers={});if(e.isUndefined(t))throw new Error("Event-type undefined.");if(!e.isFunction(n))throw new Error("Trying to add an event listener without defining a callback function.");return(i=this._observers)[t]||(i[t]=[]),this._observers[t].push({listener:n,context:r})},unbind:function(t,n,r){var i,s,o,u,a,f,l,c;r==null&&(r=null),this._observers||(this._observers={}),a=this._observers[t];if(e.isFunction(n)){c=[];for(o=f=0,l=a.length;f<l;o=++f){u=a[o],i=u.listener,s=u.context;if(n===i&&r===s){a.splice(o,1);break}c.push(void 0)}return c}return delete this._observers[t]},dispatch:function(t,n){var r,i,s,o,u,a,f,l,c;this._observers||(this._observers={});if(!e.isString(t))throw new Error("Trying to dispatch a non-standard event.");u=this._observers[t]||[],a=function(){var e,r,a;a=[];for(i=e=0,r=u.length;e<r;i=++e)o=u[i],s=o.listener,a.push(function(e,t,n,r){return n==null&&(n=null),function(){return e.apply(t,[r,n])}}(s,o.context,n,t));return a}(),c=[];for(f=0,l=a.length;f<l;f++)r=a[f],c.push(r());return c},hasEventListener:function(t){return this._observers||(this._observers={}),e.isArray(this._observers[t])&&this._observers[t].length>0}},t})}.call(this),function(){define("gremlinjs/gremlins/GremlinSwitchboard",["../core/helper"],function(e){var t,n;return t={},n={register:function(e){var t,n,r,i,s;e.bind(e.NOTIFICATION,this._broadcast,this),i=e.interests,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(this._addInterest(e,t));return s},_broadcast:function(n,r){var i,s,o,u,a,f,l;s=r.interest,o=r.notificationData;if(!e.isUndefined(t[s])){f=t[s],l=[];for(u=0,a=f.length;u<a;u++)i=f[u],l.push(this.__notify(i,s,o));return l}},_addInterest:function(n,r){return e.isUndefined(t[r])&&(t[r]=[]),t[r].push(n)},__notify:function(e,t,n){return e.inform(t,n)}}})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("gremlinjs/gremlins/GremlinLair",["../core/helper","../event/EventDispatcher","./GremlinSwitchboard"],function(n,r,i){var s,o,u,a;return u=function(t){var r,i,s,o;if(this.elements!==null){s=this.elements,o=[];for(r in s){if(!e.call(s,r))continue;i=s[r];if(!n.isString(i))throw new TypeError("Element selector have to be referenced by strings!");if(!n.isUndefined(this[r]))throw new TypeError("Element member "+r+" already defined!");o.push(this[r]=this.view.find(i))}return o}},a=function(t){var r,i,s,o,u=this;if(this.events!==null){o=this.events,s=function(e,t){var r,i,s,o,a;if(!n.isString(t))throw new TypeError("Event selectors have to be referenced by strings!");if(!n.isFunction(u[e]))throw new TypeError("Event '"+t+"' can't be bound to '"+u.name+"."+e+"', as the type is "+typeof u[e]);return s=u[e],i=t.indexOf(" "),o=i!==-1,r=o?t.substr(0,i):t,a=o?t.substr(i+1):null,u.view.on(r,a,function(){return s.apply(u,arguments),!0})};for(i in o){if(!e.call(o,i))continue;r=o[i],s(i,r)}return!0}},s=function(){function e(e,t,n){this.view=e,this.data=t,this.id=n,u.call(this,this.elements),a.call(this,this.events),this.interests===null&&(this.interests=[]),i.register(this),this.initialize()}return e.prototype.NOTIFICATION="GREMLIN_NOTIFICATION",e.prototype.CONTENT_CHANGED="gremlinjs_gremlin_content_changed",e.prototype.name="anonymous",e.prototype.initialize=function(){},e.prototype.elements=null,e.prototype.events=null,e.prototype.interests=null,e.prototype.inform=function(e,t){},e.prototype.chatter=function(e,t){return t==null&&(t={}),this.dispatch(this.NOTIFICATION,{interest:e,notificationData:t})},e.prototype.triggerChange=function(){return this.chatter(this.CONTENT_CHANGED)},e}(),n.mixin(s,r),o={create:function(e,r){var i;if(!n.isString(e)||!n.isObject(r))throw new TypeError("GremlinLair#create called with wrong parameters!");return i=function(n){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.name=e,r}(s),n.mixin(i,r),i}}})}.call(this),function(){define("gremlinjs",["./gremlinjs/gremlins/LoaderPool","./gremlinjs/gremlins/GremlinLair"],function(e,t){return{create:t.create,getLoader:e.getInstance}})}.call(this),require(["./gremlinjs"]),define("gremlinMain",function(){})})()